bring http;
bring cloud;
bring expect;
bring fs;
bring "./api.w" as a;
bring "./clusters.w" as c;
bring "./types.w" as t;
bring "./names" as names;
bring "./pool.w" as p;
bring "./bucket.w" as b;
bring "./dns" as d;

let kubeConfigFor = inflight (name: str) => {
  return {
    "apiVersion": "v1",
    "clusters": [
      {
        "cluster": {
          "certificate-authority-data": "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCVENDQWUyZ0F3SUJBZ0lJRVBDaGhXME5GRzh3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TkRBNU1UZ3dOVE15TVRSYUZ3MHpOREE1TVRZd05UTTNNVFJhTUJVeApFekFSQmdOVkJBTVRDbXQxWW1WeWJtVjBaWE13Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLCkFvSUJBUUM0YlRvV0NFNnMycnFubkhqKzZvWEVzU0FrMGhjNVRBTFN4UHc3SGV5T0JPeW5xZERvRHRvSzRQNkIKVW4yRDhmbjZaQThWZXFGRzBvcWM0OFlGMzl0anpRSUVUWjFYRnNGL0dUSkFOVVVwOEhoMXo1cTJwTnJNbjgvcQpzRlRyRkROUkRoRlNyVFplb1R5OGd2cWx1RVpRSC9aWTVsQzBwb2xxMEFrbWdnN2xET2xoWjNtaUFqYytIRnA1CjMvMkVKTDNNeXZMZVpoTFNHdVJ6cnhDTWp4UENjVld6RlV0dGYxTU9BbTNvSTl5a3hDcjM1WW1GSFNqWGZPV3oKdTRiczd1RTA5MnVNbDIybnVFUmZ0ZFdxeXZXMVdrejZWc0Q1cjJWTDRreHpRTTNhWmtwT3FSdXJ6bHVQYkJ1YQpZdVpONE82dUhWYXR2blQ2eW1qSlNxelkzMWVIQWdNQkFBR2pXVEJYTUE0R0ExVWREd0VCL3dRRUF3SUNwREFQCkJnTlZIUk1CQWY4RUJUQURBUUgvTUIwR0ExVWREZ1FXQkJTUUI5MHZXcUtRN2ZPT2pHZmFRWEN2b3lFZllUQVYKQmdOVkhSRUVEakFNZ2dwcmRXSmxjbTVsZEdWek1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQzBRcU1zRjJrSApxNngxajFrTERSWTNMaTFYTHp6ZHJVRXhOaGwvaGYzMWVLeG1yU2QyVnZTcVJJWDFrZU9oWGNhSG9JU2prY1dmCkpRdUxsL1ZoRzBvd1BDODc0WEdOUE5qVEg4Y0ZHUUNOZkRyRjNxTXlxL0NpTWlxdVB1UEhqSkdDekZBSFhWUTkKbTVaVjUzZmJ3cTRmNEw0U0ZmRGRQSWo0ZXdaaW1lMklsQmhNMkp4L0lhMnA1aTQxcnUrYmY5ajdZckozbERWZQptUTVnbHlqTkJZRGd2d1gwK0Q0dlZ0TTd3OG1PSi9LYnU5MjRnWHNuN3p5U3dQNzc2MkZVbWdPTWxIYU9BbU9XCmNXWjdZVDZTZFVTVXpHQlZyQnR2cWRWdForN1dBMzROZ203Mm1DZ2s2YmpyNFE2MHIvTlovcXM2S1g1OHUwenMKY09IbllhczcyalFRCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K",
          "server": "https://{name}.dummy.com:7443"
        },
        "name": name
      }
    ],
    "contexts": [
      {
        "name": name,
        "context": {
          "cluster": name,
          "user": name
        }
      }
    ],
    "current-context": name,
    "kind": "Config",
    "preferences": {},
    "users": [
      {
        "name": name,
        "user": {
          "client-certificate-data": "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLVENDQWhHZ0F3SUJBZ0lJYnlHa2xLaHo0bVF3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TkRBNU1UZ3dOVE15TVRSYUZ3MHlOVEE1TVRnd05UTTNNVGxhTUR3eApIekFkQmdOVkJBb1RGbXQxWW1WaFpHMDZZMngxYzNSbGNpMWhaRzFwYm5NeEdUQVhCZ05WQkFNVEVHdDFZbVZ5CmJtVjBaWE10WVdSdGFXNHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFERWczMUoKNHJPQitSaGh6Mkg3TklielRNTFBDOHMyOVhTWmpPcVY3NXBmT3BzMC93bUEyakhRbFdsVExIbEU4bldrRWxXaAppb3YrQU5wTmlwTXNKd3VXV1ZvTXBWUnZaUzN1eTBQWDFPR01yREdOcS9HUzQybStzcElpZHM1MmMxUUFWbThCCk1kWGdmZFo4d2ZVUUhpazd6OVExdVhUMzBtSW54RUlVc2hNVm1MSU42KzNTdjU1RGZkWDJnTWNvVE8vTyttWXoKOUlXZlZNNng3U25LK0FjOHcycGJoTGw0RDEzY0tXME5hR3RtS0NLTEYvaCtrcWorclArZkYrWnRERHZiaGpURQpLdXplY215bjhLNnNEQnB1WlVvWUM0REx4M2lZWi9CMjZKRHFMT01EUWpMT0dGWWlPbmRVdnBYeHJYYWEvWm1sCmI1VFd6OSt3VHltK1lTMGRBZ01CQUFHalZqQlVNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUsKQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkpBSDNTOWFvcER0ODQ2TQpaOXBCY0sraklSOWhNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJOLzlGVEVXV3pucFNCWFhDNnYzRmZJNVhpClJSc0RGNUpZUE1Wem5zTlI3czJTeWNUYitkN201M0VFQjJSM1pDTGpOdTU2TEtEUzNlSE9Bc1pOb3FlRU9tNXYKdVUwVnJNZTE4eXpjVjhiZXk2eGU4VFVnWXZGbGM5M1hLTW85SjhqN1NvS0Y4LzJ0ZnZBckVFVWFHb0ZBc2hIUQpleUoyYWNVUzlEWmN5Wm80K3JNTDNwVzllUmd3KzZkclNtQUNsRSs1bmVxUXNBejFqRFVFM0U5R1EySEl1R0paClRNTXFYSk1YN1Y2ZEtQRzUrUkdwaFZDcHorQjVuSWZmZmhPcldnWjVNMnl4SmxGRG4yS2xFQUxMT0syRVEzS24KbnM3blZuTksvdzlGRU9hS2xSNTdVMlZ3dE5rWW5Zd3dTTVZYUFhRWENvZUs1ZkhtcGEyM3pSU3k0d2JkCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K",
          "client-key-data": "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeElOOVNlS3pnZmtZWWM5aCt6U0c4MHpDend2TE52VjBtWXpxbGUrYVh6cWJOUDhKCmdOb3gwSlZwVXl4NVJQSjFwQkpWb1lxTC9nRGFUWXFUTENjTGxsbGFES1ZVYjJVdDdzdEQxOVRoakt3eGphdngKa3VOcHZyS1NJbmJPZG5OVUFGWnZBVEhWNEgzV2ZNSDFFQjRwTzgvVU5ibDA5OUppSjhSQ0ZMSVRGWml5RGV2dAowcitlUTMzVjlvREhLRXp2enZwbU0vU0ZuMVRPc2UwcHl2Z0hQTU5xVzRTNWVBOWQzQ2x0RFdoclppZ2lpeGY0CmZwS28vcXovbnhmbWJRdzcyNFkweENyczNuSnNwL0N1ckF3YWJtVktHQXVBeThkNG1HZndkdWlRNml6akEwSXkKemhoV0lqcDNWTDZWOGExMm12MlpwVytVMXMvZnNFOHB2bUV0SFFJREFRQUJBb0lCQUJsWXNGOUlTMGozWFFxNAptZld4dDdwSDYxU1RPOW5SM1FFMUtNakFCOVJDbGVSSEJPM0d0dWdsYlZsYUFpWS9jNmIrNm1hVW5TdmM1a3RjCkZWRjdrOFlIcmxLMVBHZkYwQi9kdmRsbnp0TzdIZ1VjNldLOXpGVFphWG5pZ3d6S0lVcU4yM0YzQVJRY2h2NisKY2FKcmtYdnllWGVZZlJxOTJ3VXdEaW5uTWdqMTJCcEdyUlVDVmFZVDdxdGVPOUlxTXZwNlcrem1MVk8zQnNkZAozVy9YSkNYa0VMTFppT1NoNXlHZmRDQm0wMk1kVjlLQWNUVnk3MFRHSk1IN2hOL0N0UlZWOFhVK21GTW1zdDJ3ClU3WnowUjVPR1JoVVVuRVQ0THRVUWxSTHdYbUtwOFdBc1EvQnFSNUptdmFqV2JXVC8wdHFOQ2dUVFFtSjdlTWQKRzUvYkNRRUNnWUVBMjh6KzFGb1g2d1VId0FJUXI0V0NjendVWTBNcXN2UllHN2Z0YkhIdmpsL2lxNzNEY0FTYgpDKzlnYWVJWmdjbmdVRG5reEpTTS9TV3c2K3RrMk9sdUdRZmJMbmw3dDB1T1NLeHNTQThZaytwK2NHNk9NUHdQCkFhNVRFS2V2K292MnVtdEhtd2h6cklLTmUwMzNIQ21nSGZPYnU5MFpyNGdIaXduM0RjTUlBMTBDZ1lFQTVPQ3YKMG1iVnRxOGFzV1l4RURRNExNaEg2VGlBR2lUZnUwc0Z2ZlpnZ3VMZUxzdDZmUFg5UnNPY0t2QWFNVXdRUUJNNgppbUdrMjd5M1dBMDJ2SjA0cDhieWtISmJOaUJwcXNVUENLemxQbTdZMks0VWlFQXdsTDByUStwTEdUaVFMOHYyCjRZaHlCNW1ZeHRhbGk3NGdwRXNtS0RjRGhFODFJZFIvc3lxSzlNRUNnWUVBcUlmVDFHcUg4RkhaRVdZRCtURDcKUnZRSUJkd1lQMEtPMUNJQXo2ZkVzSHZneHlJbldocU43MmJKbkNZYXZLTlhkT3dPOXBPWVR2bTVZQXNMTmk0MQpsc2VwVFVja2p2UkYwbjh5UDBZajZEWmlZRDdFazlhUWd3OXc3VkpGNG11eThGa1ZmRS9Nc2JjZ1dDejlqZ0IwCm5zS001RXl4UngrYitRWFpBaHBLYUprQ2dZRUFtYzlOR080MnJPQWI1aCt3MVJ6aXEyV2t2ZHhVYWoxaGhUSXoKbDZkYzBGaTV5MlMrMmY5TnlDSm9ib3FRYjVTWVR4Y2MvaVlFYmc3eWYxL1I2d3NWS2RzTzQzZVdTRmViNjBFbQppMFAxZ3ZGbkZLWlg4Z0NCSlZQRElZN3dEUER3Sk03RENHbHppQnYyaVpseUF1a3djbmgyR2d4dWRwbnNNT0huCk4zWmRqNEVDZ1lCeWgvcXBxNWtTaGQzSndpNGJWMElLUCtiVzkwRDJaUkFSYXJpeU1udW11d0VNcmtqck8vOEgKalpxZ3diSGhYdnU0WTZxREQ5UGlNRjhpZ2tBTjNiUGE5Sk1HUzl5NzZ3VURhek1zTnBEbS9HT2VkQUVSaFJDUQorUGd1WHkwNlBlR0dWdmdlMExoUjR1V2dvTkJGTStWSGlzallUa0NqV1FRL21tMTZNRVVjc2c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo="
        }
      }
    ]
  };
};

class MockNames impl names.INameGenerator {
  c: cloud.Counter;
  new() {
    this.c = new cloud.Counter();
  }

  pub inflight next(): str {
    return "q8s-{this.c.inc()}";
  }
}

let pool = new p.Pool(bucket: new b.SimulatedPoolBucket());
let dns = new d.DnsSimulation();

let api = new a.Api(
  names: new MockNames(),
  clusters: new c.Clusters(),
  dns: dns,
  user: "dummy",
  pool: pool,
);

test "create new cluster with defaults" {
  let response = http.post("{api.url}/clusters");
  expect.equal(response.status, 200);

  let body = t.Cluster.parseJson(response.body);

  expect.equal(body, {
    "host": {
      "instanceId": "i-2",
      "instanceType": {
        "size": "small",
        "name": "t4g.small",
        "dailyCost": 0.2016,
        "monthlyCost": 6.13,
        "vcpu": 2,
        "memory": 2,
        "provider": "aws"
      },
      "kubeconfig": "YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VSQ1ZFTkRRV1V5WjBGM1NVSkJaMGxKUlZCRGFHaFhNRTVHUnpoM1JGRlpTa3R2V2tsb2RtTk9RVkZGVEVKUlFYZEdWRVZVVFVKRlIwRXhWVVVLUVhoTlMyRXpWbWxhV0VwMVdsaFNiR042UVdWR2R6QjVUa1JCTlUxVVozZE9WRTE1VFZSU1lVWjNNSHBPUkVFMVRWUlpkMDVVVFROTlZGSmhUVUpWZUFwRmVrRlNRbWRPVmtKQlRWUkRiWFF4V1cxV2VXSnRWakJhV0UxM1oyZEZhVTFCTUVkRFUzRkhVMGxpTTBSUlJVSkJVVlZCUVRSSlFrUjNRWGRuWjBWTENrRnZTVUpCVVVNMFlsUnZWME5GTm5NeWNuRnVia2hxS3padldFVnpVMEZyTUdoak5WUkJURk40VUhjM1NHVjVUMEpQZVc1eFpFUnZSSFJ2U3pSUU5rSUtWVzR5UkRobWJqWmFRVGhXWlhGR1J6QnZjV00wT0ZsR016bDBhbnBSU1VWVVdqRllSbk5HTDBkVVNrRk9WVlZ3T0Vob01YbzFjVEp3VG5KTmJqZ3ZjUXB6UmxSeVJrUk9Va1JvUmxOeVZGcGxiMVI1T0dkMmNXeDFSVnBSU0M5YVdUVnNRekJ3YjJ4eE1FRnJiV2RuTjJ4RVQyeG9Xak50YVVGcVl5dElSbkExQ2pNdk1rVktURE5OZVhaTVpWcG9URk5IZFZKNmNuaERUV3A0VUVOalZsZDZSbFYwZEdZeFRVOUJiVE52U1RsNWEzaERjak0xV1cxR1NGTnFXR1pQVjNvS2RUUmljemQxUlRBNU1uVk5iREl5Ym5WRlVtWjBaRmR4ZVhaWE1WZHJlalpXYzBRMWNqSldURFJyZUhwUlRUTmhXbXR3VDNGU2RYSjZiSFZRWWtKMVlRcFpkVnBPTkU4MmRVaFdZWFIyYmxRMmVXMXFTbE54ZWxrek1XVklRV2ROUWtGQlIycFhWRUpZVFVFMFIwRXhWV1JFZDBWQ0wzZFJSVUYzU1VOd1JFRlFDa0puVGxaSVVrMUNRV1k0UlVKVVFVUkJVVWd2VFVJd1IwRXhWV1JFWjFGWFFrSlRVVUk1TUhaWGNVdFJOMlpQVDJwSFptRlJXRU4yYjNsRlpsbFVRVllLUW1kT1ZraFNSVVZFYWtGTloyZHdjbVJYU214amJUVnNaRWRXZWsxQk1FZERVM0ZIVTBsaU0wUlJSVUpEZDFWQlFUUkpRa0ZSUXpCUmNVMXpSakpyU0FweE5uZ3hhakZyVEVSU1dUTk1hVEZZVEhwNlpISlZSWGhPYUd3dmFHWXpNV1ZMZUcxeVUyUXlWblpUY1ZKSldERnJaVTlvV0dOaFNHOUpVMnByWTFkbUNrcFJkVXhzTDFab1J6QnZkMUJET0RjMFdFZE9VRTVxVkVnNFkwWkhVVU5PWmtSeVJqTnhUWGx4TDBOcFRXbHhkVkIxVUVocVNrZERla1pCU0ZoV1VUa0tiVFZhVmpVelptSjNjVFJtTkV3MFUwWm1SR1JRU1dvMFpYZGFhVzFsTWtsc1FtaE5Na3A0TDBsaE1uQTFhVFF4Y25VclltWTVhamRaY2tvemJFUldaUXB0VVRWbmJIbHFUa0paUkdkMmQxZ3dLMFEwZGxaMFRUZDNPRzFQU2k5TFluVTVNalJuV0hOdU4zcDVVM2RRTnpjMk1rWlZiV2RQVFd4SVlVOUJiVTlYQ21OWFdqZFpWRFpUWkZWVFZYcEhRbFp5UW5SMmNXUldkRm9yTjFkQk16Uk9aMjAzTW0xRFoyczJZbXB5TkZFMk1ISXZUbG92Y1hNMlMxZzFPSFV3ZW5NS1kwOUlibGxoY3pjeWFsRlJDaTB0TFMwdFJVNUVJRU5GVWxSSlJrbERRVlJGTFMwdExTMEsKICAgIHNlcnZlcjogaHR0cHM6Ly8wLjAuMC4wOjc0NDMKICBuYW1lOiBraW5kLWtpbmQKY29udGV4dHM6Ci0gY29udGV4dDoKICAgIGNsdXN0ZXI6IGtpbmQta2luZAogICAgdXNlcjoga2luZC1raW5kCiAgbmFtZToga2luZC1raW5kCmN1cnJlbnQtY29udGV4dDoga2luZC1raW5kCmtpbmQ6IENvbmZpZwpwcmVmZXJlbmNlczoge30KdXNlcnM6Ci0gbmFtZToga2luZC1raW5kCiAgdXNlcjoKICAgIGNsaWVudC1jZXJ0aWZpY2F0ZS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VSTFZFTkRRV2hIWjBGM1NVSkJaMGxKWW5sSGEyeExhSG8wYlZGM1JGRlpTa3R2V2tsb2RtTk9RVkZGVEVKUlFYZEdWRVZVVFVKRlIwRXhWVVVLUVhoTlMyRXpWbWxhV0VwMVdsaFNiR042UVdWR2R6QjVUa1JCTlUxVVozZE9WRTE1VFZSU1lVWjNNSGxPVkVFMVRWUm5kMDVVVFROTlZHeGhUVVIzZUFwSWVrRmtRbWRPVmtKQmIxUkdiWFF4V1cxV2FGcEhNRFpaTW5neFl6TlNiR05wTVdoYVJ6RndZbTVOZUVkVVFWaENaMDVXUWtGTlZFVkhkREZaYlZaNUNtSnRWakJhV0UxMFdWZFNkR0ZYTkhkblowVnBUVUV3UjBOVGNVZFRTV0l6UkZGRlFrRlJWVUZCTkVsQ1JIZEJkMmRuUlV0QmIwbENRVkZFUldjek1Vb0tOSEpQUWl0U2FHaDZNa2czVGtsaWVsUk5URkJET0hNeU9WaFRXbXBQY1ZZM05YQm1UM0J6TUM5M2JVRXlha2hSYkZkc1ZFeEliRVU0YmxkclJXeFhhQXBwYjNZclFVNXdUbWx3VFhOS2QzVlhWMVp2VFhCV1VuWmFVek4xZVRCUVdERlBSMDF5UkVkT2NTOUhVelF5YlN0emNFbHBaSE0xTW1NeFVVRldiVGhDQ2sxa1dHZG1aRm80ZDJaVlVVaHBhemQ2T1ZFeGRWaFVNekJ0U1c1NFJVbFZjMmhOVm0xTVNVNDJLek5UZGpVMVJHWmtXREpuVFdOdlZFOHZUeXR0V1hvS09VbFhabFpOTm5nM1UyNUxLMEZqT0hjeWNHSm9UR3cwUkRFelkwdFhNRTVoUjNSdFMwTkxURVl2YUN0cmNXb3JjbEFyWmtZclduUkVSSFppYUdwVVJRcExkWHBsWTIxNWJqaExObk5FUW5CMVdsVnZXVU0wUkV4NE0ybFpXaTlDTWpaS1JIRk1UMDFFVVdwTVQwZEdXV2xQYm1SVmRuQlllSEpZWVdFdldtMXNDbUkxVkZkNk9TdDNWSGx0SzFsVE1HUkJaMDFDUVVGSGFsWnFRbFZOUVRSSFFURlZaRVIzUlVJdmQxRkZRWGRKUm05RVFWUkNaMDVXU0ZOVlJVUkVRVXNLUW1kbmNrSm5SVVpDVVdORVFXcEJUVUpuVGxaSVVrMUNRV1k0UlVGcVFVRk5RamhIUVRGVlpFbDNVVmxOUW1GQlJrcEJTRE5UT1dGdmNFUjBPRFEyVFFwYU9YQkNZMHNyYWtsU09XaE5RVEJIUTFOeFIxTkpZak5FVVVWQ1EzZFZRVUUwU1VKQlVVSk9MemxHVkVWWFYzcHVjRk5DV0ZoRE5uWXpSbVpKTlZocENsSlNjMFJHTlVwWlVFMVdlbTV6VGxJM2N6SlRlV05VWWl0a04yMDFNMFZGUWpKU00xcERUR3BPZFRVMlRFdEVVek5sU0U5QmMxcE9iM0ZsUlU5dE5YWUtkVlV3Vm5KTlpURTRlWHBqVmpoaVpYazJlR1U0VkZWbldYWkdiR001TTFoTFRXODVTamhxTjFOdlMwWTRMekowWm5aQmNrVkZWV0ZIYjBaQmMyaElVUXBsZVVveVlXTlZVemxFV21ONVdtODBLM0pOVEROd1Z6bGxVbWQzS3paa2NsTnRRVU5zUlNzMWJtVnhVWE5CZWpGcVJGVkZNMFU1UjFFeVNFbDFSMHBhQ2xSTlRYRllTazFZTjFZMlpFdFFSelVyVWtkd2FGWkRjSG9yUWpWdVNXWm1abWhQY2xkbldqVk5Nbmw0U214R1JHNHlTMnhGUVV4TVQwc3lSVkV6UzI0S2JuTTNibFp1VGtzdmR6bEdSVTloUzJ4U05UZFZNbFozZEU1cldXNVpkM2RUVFZaWVVGaFJXRU52WlVzMVpraHRjR0V5TTNwU1UzazBkMkprQ2kwdExTMHRSVTVFSUVORlVsUkpSa2xEUVZSRkxTMHRMUzBLCiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmNFRkpRa0ZCUzBOQlVVVkJlRWxPT1ZObFMzcG5abXRaV1dNNWFDdDZVMGM0TUhwRGVuZDJURTUyVmpCdFdYcHhiR1VyWVZoNmNXSk9VRGhLQ21kT2IzZ3dTbFp3VlhsNE5WSlFTakZ3UWtwV2IxbHhUQzluUkdGVVdYRlVURU5qVEd4c2JHRkVTMVpWWWpKVmREZHpkRVF4T1ZSb2FrdDNlR3BoZG5nS2EzVk9jSFp5UzFOSmJtSlBaRzVPVlVGR1duWkJWRWhXTkVnelYyWk5TREZGUWpSd1R6Z3ZWVTVpYkRBNU9VcHBTamhTUTBaTVNWUkdXbWw1UkdWMmRBb3djaXRsVVRNelZqbHZSRWhMUlhwMmVuWndiVTB2VTBadU1WUlBjMlV3Y0hsMlowaFFUVTV4VnpSVE5XVkJPV1F6UTJ4MFJGZG9jbHBwWjJscGVHWTBDbVp3UzI4dmNYb3ZibmhtYldKUmR6Y3lORmt3ZUVOeWN6TnVTbk53TDBOMWNrRjNZV0p0Vmt0SFFYVkJlVGhrTkcxSFpuZGtkV2xSTm1sNmFrRXdTWGtLZW1ob1YwbHFjRE5XVERaV09HRXhNbTEyTWxwd1Z5dFZNWE12Wm5ORk9IQjJiVVYwU0ZGSlJFRlJRVUpCYjBsQ1FVSnNXWE5HT1VsVE1Hb3pXRkZ4TkFwdFpsZDRkRGR3U0RZeFUxUlBPVzVTTTFGRk1VdE5ha0ZDT1ZKRGJHVlNTRUpQTTBkMGRXZHNZbFpzWVVGcFdTOWpObUlyTm0xaFZXNVRkbU0xYTNSakNrWldSamRyT0ZsSWNteExNVkJIWmtZd1FpOWtkbVJzYm5wMFR6ZElaMVZqTmxkTE9YcEdWRnBoV0c1cFozZDZTMGxWY1U0eU0wWXpRVkpSWTJoMk5pc0tZMkZLY210WWRubGxXR1ZaWmxKeE9USjNWWGRFYVc1dVRXZHFNVEpDY0VkeVVsVkRWbUZaVkRkeGRHVlBPVWx4VFhad05sY3JlbTFNVms4elFuTmtaQW96Vnk5WVNrTllhMFZNVEZwcFQxTm9OWGxIWm1SRFFtMHdNazFrVmpsTFFXTlVWbmszTUZSSFNrMUlOMmhPTDBOMFVsWldPRmhWSzIxR1RXMXpkREozQ2xVM1dub3dValZQUjFKb1ZWVnVSVlEwVEhSVlVXeFNUSGRZYlV0d09GZEJjMUV2UW5GU05VcHRkbUZxVjJKWFZDOHdkSEZPUTJkVVZGRnRTamRsVFdRS1J6VXZZa05SUlVObldVVkJNamg2S3pGR2IxZzJkMVZJZDBGSlVYSTBWME5qZW5kVldUQk5jWE4yVWxsSE4yWjBZa2hJZG1wc0wybHhOek5FWTBGVFlncERLemxuWVdWSldtZGpibWRWUkc1cmVFcFRUUzlUVjNjMkszUnJNazlzZFVkUlptSk1ibXczZERCMVQxTkxlSE5UUVRoWmF5dHdLMk5ITms5TlVIZFFDa0ZoTlZSRlMyVjJLMjkyTW5WdGRFaHRkMmg2Y2tsTFRtVXdNek5JUTIxblNHWlBZblU1TUZweU5HZElhWGR1TTBSalRVbEJNVEJEWjFsRlFUVlBRM1lLTUcxaVZuUnhPR0Z6VjFsNFJVUlJORXhOYUVnMlZHbEJSMmxVWm5Vd2MwWjJabHBuWjNWTVpVeHpkRFptVUZnNVVuTlBZMHQyUVdGTlZYZFJVVUpOTmdwcGJVZHJNamQ1TTFkQk1ESjJTakEwY0RoaWVXdElTbUpPYVVKd2NYTlZVRU5MZW14UWJUZFpNa3MwVldsRlFYZHNUREJ5VVN0d1RFZFVhVkZNT0hZeUNqUlphSGxDTlcxWmVIUmhiR2szTkdkd1JYTnRTMFJqUkdoRk9ERkpaRkl2YzNseFN6bE5SVU5uV1VWQmNVbG1WREZIY1VnNFJraGFSVmRaUkN0VVJEY0tVblpSU1VKa2QxbFFNRXRQTVVOSlFYbzJaa1Z6U0habmVIbEpibGRvY1U0M01tSktia05aWVhaTFRsaGtUM2RQT1hCUFdWUjJiVFZaUVhOTVRtazBNUXBzYzJWd1ZGVmphMnAyVWtZd2JqaDVVREJaYWpaRVdtbFpSRGRGYXpsaFVXZDNPWGMzVmtwR05HMTFlVGhHYTFabVJTOU5jMkpqWjFkRGVqbHFaMEl3Q201elMwMDFSWGw0VW5ncllpdFJXRnBCYUhCTFlVcHJRMmRaUlVGdFl6bE9SMDgwTW5KUFFXSTFhQ3QzTVZKNmFYRXlWMnQyWkhoVllXb3hhR2hVU1hvS2JEWmtZekJHYVRWNU1sTXJNbVk1VG5sRFNtOWliM0ZSWWpWVFdWUjRZMk12YVZsRlltYzNlV1l4TDFJMmQzTldTMlJ6VHpRelpWZFRSbVZpTmpCRmJRcHBNRkF4WjNaR2JrWkxXbGc0WjBOQ1NsWlFSRWxaTjNkRVVFUjNTazAzUkVOSGJIcHBRbll5YVZwc2VVRjFhM2RqYm1neVIyZDRkV1J3Ym5OTlQwaHVDazR6V21ScU5FVkRaMWxDZVdndmNYQnhOV3RUYUdRelNuZHBOR0pXTUVsTFVDdGlWemt3UkRKYVVrRlNZWEpwZVUxdWRXMTFkMFZOY210cWNrOHZPRWdLYWxweFozZGlTR2hZZG5VMFdUWnhSRVE1VUdsTlJqaHBaMnRCVGpOaVVHRTVTazFIVXpsNU56WjNWVVJoZWsxelRuQkViUzlIVDJWa1FVVlNhRkpEVVFvclVHZDFXSGt3TmxCbFIwZFdkbWRsTUV4b1VqUjFWMmR2VGtKR1RTdFdTR2x6YWxsVWEwTnFWMUZSTDIxdE1UWk5SVlZqYzJjOVBRb3RMUzB0TFVWT1JDQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUW89Cg==",
      "provider": "aws",
      "publicDns": "ec2-1-2-3-2.compute-1.amazonaws.com",
      "publicIp": "1.2.3.2",
      "region": "us-east-1",
      "registryPassword": "<password-2>",
      "size": "medium",
      "sshPrivateKey": "<private-key-2>"
    },
    "hostname": "q8s-0.dummy.com",
    "kubeconfig": {
      "apiVersion": "v1",
      "clusters": [
        {
          "cluster": {
            "server": "https://q8s-0.dummy.com:7443"
          },
          "name": "q8s-0"
        }
      ],
      "contexts": [
        {
          "name": "q8s-0",
          "context": {
            "cluster": "q8s-0",
            "user": "q8s-0"
          }
        }
      ],
      "current-context": "q8s-0",
      "kind": "Config",
      "preferences": {},
      "users": [
        {
          "name": "q8s-0",
          "user": {
            "client-certificate-data": "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLVENDQWhHZ0F3SUJBZ0lJYnlHa2xLaHo0bVF3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TkRBNU1UZ3dOVE15TVRSYUZ3MHlOVEE1TVRnd05UTTNNVGxhTUR3eApIekFkQmdOVkJBb1RGbXQxWW1WaFpHMDZZMngxYzNSbGNpMWhaRzFwYm5NeEdUQVhCZ05WQkFNVEVHdDFZbVZ5CmJtVjBaWE10WVdSdGFXNHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFERWczMUoKNHJPQitSaGh6Mkg3TklielRNTFBDOHMyOVhTWmpPcVY3NXBmT3BzMC93bUEyakhRbFdsVExIbEU4bldrRWxXaAppb3YrQU5wTmlwTXNKd3VXV1ZvTXBWUnZaUzN1eTBQWDFPR01yREdOcS9HUzQybStzcElpZHM1MmMxUUFWbThCCk1kWGdmZFo4d2ZVUUhpazd6OVExdVhUMzBtSW54RUlVc2hNVm1MSU42KzNTdjU1RGZkWDJnTWNvVE8vTyttWXoKOUlXZlZNNng3U25LK0FjOHcycGJoTGw0RDEzY0tXME5hR3RtS0NLTEYvaCtrcWorclArZkYrWnRERHZiaGpURQpLdXplY215bjhLNnNEQnB1WlVvWUM0REx4M2lZWi9CMjZKRHFMT01EUWpMT0dGWWlPbmRVdnBYeHJYYWEvWm1sCmI1VFd6OSt3VHltK1lTMGRBZ01CQUFHalZqQlVNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUsKQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkpBSDNTOWFvcER0ODQ2TQpaOXBCY0sraklSOWhNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJOLzlGVEVXV3pucFNCWFhDNnYzRmZJNVhpClJSc0RGNUpZUE1Wem5zTlI3czJTeWNUYitkN201M0VFQjJSM1pDTGpOdTU2TEtEUzNlSE9Bc1pOb3FlRU9tNXYKdVUwVnJNZTE4eXpjVjhiZXk2eGU4VFVnWXZGbGM5M1hLTW85SjhqN1NvS0Y4LzJ0ZnZBckVFVWFHb0ZBc2hIUQpleUoyYWNVUzlEWmN5Wm80K3JNTDNwVzllUmd3KzZkclNtQUNsRSs1bmVxUXNBejFqRFVFM0U5R1EySEl1R0paClRNTXFYSk1YN1Y2ZEtQRzUrUkdwaFZDcHorQjVuSWZmZmhPcldnWjVNMnl4SmxGRG4yS2xFQUxMT0syRVEzS24KbnM3blZuTksvdzlGRU9hS2xSNTdVMlZ3dE5rWW5Zd3dTTVZYUFhRWENvZUs1ZkhtcGEyM3pSU3k0d2JkCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K",
            "client-key-data": "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeElOOVNlS3pnZmtZWWM5aCt6U0c4MHpDend2TE52VjBtWXpxbGUrYVh6cWJOUDhKCmdOb3gwSlZwVXl4NVJQSjFwQkpWb1lxTC9nRGFUWXFUTENjTGxsbGFES1ZVYjJVdDdzdEQxOVRoakt3eGphdngKa3VOcHZyS1NJbmJPZG5OVUFGWnZBVEhWNEgzV2ZNSDFFQjRwTzgvVU5ibDA5OUppSjhSQ0ZMSVRGWml5RGV2dAowcitlUTMzVjlvREhLRXp2enZwbU0vU0ZuMVRPc2UwcHl2Z0hQTU5xVzRTNWVBOWQzQ2x0RFdoclppZ2lpeGY0CmZwS28vcXovbnhmbWJRdzcyNFkweENyczNuSnNwL0N1ckF3YWJtVktHQXVBeThkNG1HZndkdWlRNml6akEwSXkKemhoV0lqcDNWTDZWOGExMm12MlpwVytVMXMvZnNFOHB2bUV0SFFJREFRQUJBb0lCQUJsWXNGOUlTMGozWFFxNAptZld4dDdwSDYxU1RPOW5SM1FFMUtNakFCOVJDbGVSSEJPM0d0dWdsYlZsYUFpWS9jNmIrNm1hVW5TdmM1a3RjCkZWRjdrOFlIcmxLMVBHZkYwQi9kdmRsbnp0TzdIZ1VjNldLOXpGVFphWG5pZ3d6S0lVcU4yM0YzQVJRY2h2NisKY2FKcmtYdnllWGVZZlJxOTJ3VXdEaW5uTWdqMTJCcEdyUlVDVmFZVDdxdGVPOUlxTXZwNlcrem1MVk8zQnNkZAozVy9YSkNYa0VMTFppT1NoNXlHZmRDQm0wMk1kVjlLQWNUVnk3MFRHSk1IN2hOL0N0UlZWOFhVK21GTW1zdDJ3ClU3WnowUjVPR1JoVVVuRVQ0THRVUWxSTHdYbUtwOFdBc1EvQnFSNUptdmFqV2JXVC8wdHFOQ2dUVFFtSjdlTWQKRzUvYkNRRUNnWUVBMjh6KzFGb1g2d1VId0FJUXI0V0NjendVWTBNcXN2UllHN2Z0YkhIdmpsL2lxNzNEY0FTYgpDKzlnYWVJWmdjbmdVRG5reEpTTS9TV3c2K3RrMk9sdUdRZmJMbmw3dDB1T1NLeHNTQThZaytwK2NHNk9NUHdQCkFhNVRFS2V2K292MnVtdEhtd2h6cklLTmUwMzNIQ21nSGZPYnU5MFpyNGdIaXduM0RjTUlBMTBDZ1lFQTVPQ3YKMG1iVnRxOGFzV1l4RURRNExNaEg2VGlBR2lUZnUwc0Z2ZlpnZ3VMZUxzdDZmUFg5UnNPY0t2QWFNVXdRUUJNNgppbUdrMjd5M1dBMDJ2SjA0cDhieWtISmJOaUJwcXNVUENLemxQbTdZMks0VWlFQXdsTDByUStwTEdUaVFMOHYyCjRZaHlCNW1ZeHRhbGk3NGdwRXNtS0RjRGhFODFJZFIvc3lxSzlNRUNnWUVBcUlmVDFHcUg4RkhaRVdZRCtURDcKUnZRSUJkd1lQMEtPMUNJQXo2ZkVzSHZneHlJbldocU43MmJKbkNZYXZLTlhkT3dPOXBPWVR2bTVZQXNMTmk0MQpsc2VwVFVja2p2UkYwbjh5UDBZajZEWmlZRDdFazlhUWd3OXc3VkpGNG11eThGa1ZmRS9Nc2JjZ1dDejlqZ0IwCm5zS001RXl4UngrYitRWFpBaHBLYUprQ2dZRUFtYzlOR080MnJPQWI1aCt3MVJ6aXEyV2t2ZHhVYWoxaGhUSXoKbDZkYzBGaTV5MlMrMmY5TnlDSm9ib3FRYjVTWVR4Y2MvaVlFYmc3eWYxL1I2d3NWS2RzTzQzZVdTRmViNjBFbQppMFAxZ3ZGbkZLWlg4Z0NCSlZQRElZN3dEUER3Sk03RENHbHppQnYyaVpseUF1a3djbmgyR2d4dWRwbnNNT0huCk4zWmRqNEVDZ1lCeWgvcXBxNWtTaGQzSndpNGJWMElLUCtiVzkwRDJaUkFSYXJpeU1udW11d0VNcmtqck8vOEgKalpxZ3diSGhYdnU0WTZxREQ5UGlNRjhpZ2tBTjNiUGE5Sk1HUzl5NzZ3VURhek1zTnBEbS9HT2VkQUVSaFJDUQorUGd1WHkwNlBlR0dWdmdlMExoUjR1V2dvTkJGTStWSGlzallUa0NqV1FRL21tMTZNRVVjc2c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo="
          }
        }
      ]
    },
    "name": "q8s-0",
    "provider": "aws",
    "region": "us-east-1",
    "size": "medium"
  });


  expect.equal(dns.tryResolve("q8s-0.dummy.com"), "1.2.3.2");
}

test "create new cluster with custom options" {
  let response = http.post("{api.url}/clusters", body: Json.stringify(t.ClusterOptions {
    provider: t.Provider.gcp,
    region: "america",
    size: t.Size.small
  }));

  let body = t.Cluster.parseJson(response.body);
  expect.equal(body, {
    "host": {
      "instanceId": "i-1",
      "instanceType": {
        "size": "small",
        "name": "t4g.small",
        "dailyCost": 0.2016,
        "monthlyCost": 6.13,
        "vcpu": 2,
        "memory": 2,
        "provider": "aws"
      },
      "kubeconfig": "YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VSQ1ZFTkRRV1V5WjBGM1NVSkJaMGxKUlZCRGFHaFhNRTVHUnpoM1JGRlpTa3R2V2tsb2RtTk9RVkZGVEVKUlFYZEdWRVZVVFVKRlIwRXhWVVVLUVhoTlMyRXpWbWxhV0VwMVdsaFNiR042UVdWR2R6QjVUa1JCTlUxVVozZE9WRTE1VFZSU1lVWjNNSHBPUkVFMVRWUlpkMDVVVFROTlZGSmhUVUpWZUFwRmVrRlNRbWRPVmtKQlRWUkRiWFF4V1cxV2VXSnRWakJhV0UxM1oyZEZhVTFCTUVkRFUzRkhVMGxpTTBSUlJVSkJVVlZCUVRSSlFrUjNRWGRuWjBWTENrRnZTVUpCVVVNMFlsUnZWME5GTm5NeWNuRnVia2hxS3padldFVnpVMEZyTUdoak5WUkJURk40VUhjM1NHVjVUMEpQZVc1eFpFUnZSSFJ2U3pSUU5rSUtWVzR5UkRobWJqWmFRVGhXWlhGR1J6QnZjV00wT0ZsR016bDBhbnBSU1VWVVdqRllSbk5HTDBkVVNrRk9WVlZ3T0Vob01YbzFjVEp3VG5KTmJqZ3ZjUXB6UmxSeVJrUk9Va1JvUmxOeVZGcGxiMVI1T0dkMmNXeDFSVnBSU0M5YVdUVnNRekJ3YjJ4eE1FRnJiV2RuTjJ4RVQyeG9Xak50YVVGcVl5dElSbkExQ2pNdk1rVktURE5OZVhaTVpWcG9URk5IZFZKNmNuaERUV3A0VUVOalZsZDZSbFYwZEdZeFRVOUJiVE52U1RsNWEzaERjak0xV1cxR1NGTnFXR1pQVjNvS2RUUmljemQxUlRBNU1uVk5iREl5Ym5WRlVtWjBaRmR4ZVhaWE1WZHJlalpXYzBRMWNqSldURFJyZUhwUlRUTmhXbXR3VDNGU2RYSjZiSFZRWWtKMVlRcFpkVnBPTkU4MmRVaFdZWFIyYmxRMmVXMXFTbE54ZWxrek1XVklRV2ROUWtGQlIycFhWRUpZVFVFMFIwRXhWV1JFZDBWQ0wzZFJSVUYzU1VOd1JFRlFDa0puVGxaSVVrMUNRV1k0UlVKVVFVUkJVVWd2VFVJd1IwRXhWV1JFWjFGWFFrSlRVVUk1TUhaWGNVdFJOMlpQVDJwSFptRlJXRU4yYjNsRlpsbFVRVllLUW1kT1ZraFNSVVZFYWtGTloyZHdjbVJYU214amJUVnNaRWRXZWsxQk1FZERVM0ZIVTBsaU0wUlJSVUpEZDFWQlFUUkpRa0ZSUXpCUmNVMXpSakpyU0FweE5uZ3hhakZyVEVSU1dUTk1hVEZZVEhwNlpISlZSWGhPYUd3dmFHWXpNV1ZMZUcxeVUyUXlWblpUY1ZKSldERnJaVTlvV0dOaFNHOUpVMnByWTFkbUNrcFJkVXhzTDFab1J6QnZkMUJET0RjMFdFZE9VRTVxVkVnNFkwWkhVVU5PWmtSeVJqTnhUWGx4TDBOcFRXbHhkVkIxVUVocVNrZERla1pCU0ZoV1VUa0tiVFZhVmpVelptSjNjVFJtTkV3MFUwWm1SR1JRU1dvMFpYZGFhVzFsTWtsc1FtaE5Na3A0TDBsaE1uQTFhVFF4Y25VclltWTVhamRaY2tvemJFUldaUXB0VVRWbmJIbHFUa0paUkdkMmQxZ3dLMFEwZGxaMFRUZDNPRzFQU2k5TFluVTVNalJuV0hOdU4zcDVVM2RRTnpjMk1rWlZiV2RQVFd4SVlVOUJiVTlYQ21OWFdqZFpWRFpUWkZWVFZYcEhRbFp5UW5SMmNXUldkRm9yTjFkQk16Uk9aMjAzTW0xRFoyczJZbXB5TkZFMk1ISXZUbG92Y1hNMlMxZzFPSFV3ZW5NS1kwOUlibGxoY3pjeWFsRlJDaTB0TFMwdFJVNUVJRU5GVWxSSlJrbERRVlJGTFMwdExTMEsKICAgIHNlcnZlcjogaHR0cHM6Ly8wLjAuMC4wOjc0NDMKICBuYW1lOiBraW5kLWtpbmQKY29udGV4dHM6Ci0gY29udGV4dDoKICAgIGNsdXN0ZXI6IGtpbmQta2luZAogICAgdXNlcjoga2luZC1raW5kCiAgbmFtZToga2luZC1raW5kCmN1cnJlbnQtY29udGV4dDoga2luZC1raW5kCmtpbmQ6IENvbmZpZwpwcmVmZXJlbmNlczoge30KdXNlcnM6Ci0gbmFtZToga2luZC1raW5kCiAgdXNlcjoKICAgIGNsaWVudC1jZXJ0aWZpY2F0ZS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VSTFZFTkRRV2hIWjBGM1NVSkJaMGxKWW5sSGEyeExhSG8wYlZGM1JGRlpTa3R2V2tsb2RtTk9RVkZGVEVKUlFYZEdWRVZVVFVKRlIwRXhWVVVLUVhoTlMyRXpWbWxhV0VwMVdsaFNiR042UVdWR2R6QjVUa1JCTlUxVVozZE9WRTE1VFZSU1lVWjNNSGxPVkVFMVRWUm5kMDVVVFROTlZHeGhUVVIzZUFwSWVrRmtRbWRPVmtKQmIxUkdiWFF4V1cxV2FGcEhNRFpaTW5neFl6TlNiR05wTVdoYVJ6RndZbTVOZUVkVVFWaENaMDVXUWtGTlZFVkhkREZaYlZaNUNtSnRWakJhV0UxMFdWZFNkR0ZYTkhkblowVnBUVUV3UjBOVGNVZFRTV0l6UkZGRlFrRlJWVUZCTkVsQ1JIZEJkMmRuUlV0QmIwbENRVkZFUldjek1Vb0tOSEpQUWl0U2FHaDZNa2czVGtsaWVsUk5URkJET0hNeU9WaFRXbXBQY1ZZM05YQm1UM0J6TUM5M2JVRXlha2hSYkZkc1ZFeEliRVU0YmxkclJXeFhhQXBwYjNZclFVNXdUbWx3VFhOS2QzVlhWMVp2VFhCV1VuWmFVek4xZVRCUVdERlBSMDF5UkVkT2NTOUhVelF5YlN0emNFbHBaSE0xTW1NeFVVRldiVGhDQ2sxa1dHZG1aRm80ZDJaVlVVaHBhemQ2T1ZFeGRWaFVNekJ0U1c1NFJVbFZjMmhOVm0xTVNVNDJLek5UZGpVMVJHWmtXREpuVFdOdlZFOHZUeXR0V1hvS09VbFhabFpOTm5nM1UyNUxLMEZqT0hjeWNHSm9UR3cwUkRFelkwdFhNRTVoUjNSdFMwTkxURVl2YUN0cmNXb3JjbEFyWmtZclduUkVSSFppYUdwVVJRcExkWHBsWTIxNWJqaExObk5FUW5CMVdsVnZXVU0wUkV4NE0ybFpXaTlDTWpaS1JIRk1UMDFFVVdwTVQwZEdXV2xQYm1SVmRuQlllSEpZWVdFdldtMXNDbUkxVkZkNk9TdDNWSGx0SzFsVE1HUkJaMDFDUVVGSGFsWnFRbFZOUVRSSFFURlZaRVIzUlVJdmQxRkZRWGRKUm05RVFWUkNaMDVXU0ZOVlJVUkVRVXNLUW1kbmNrSm5SVVpDVVdORVFXcEJUVUpuVGxaSVVrMUNRV1k0UlVGcVFVRk5RamhIUVRGVlpFbDNVVmxOUW1GQlJrcEJTRE5UT1dGdmNFUjBPRFEyVFFwYU9YQkNZMHNyYWtsU09XaE5RVEJIUTFOeFIxTkpZak5FVVVWQ1EzZFZRVUUwU1VKQlVVSk9MemxHVkVWWFYzcHVjRk5DV0ZoRE5uWXpSbVpKTlZocENsSlNjMFJHTlVwWlVFMVdlbTV6VGxJM2N6SlRlV05VWWl0a04yMDFNMFZGUWpKU00xcERUR3BPZFRVMlRFdEVVek5sU0U5QmMxcE9iM0ZsUlU5dE5YWUtkVlV3Vm5KTlpURTRlWHBqVmpoaVpYazJlR1U0VkZWbldYWkdiR001TTFoTFRXODVTamhxTjFOdlMwWTRMekowWm5aQmNrVkZWV0ZIYjBaQmMyaElVUXBsZVVveVlXTlZVemxFV21ONVdtODBLM0pOVEROd1Z6bGxVbWQzS3paa2NsTnRRVU5zUlNzMWJtVnhVWE5CZWpGcVJGVkZNMFU1UjFFeVNFbDFSMHBhQ2xSTlRYRllTazFZTjFZMlpFdFFSelVyVWtkd2FGWkRjSG9yUWpWdVNXWm1abWhQY2xkbldqVk5Nbmw0U214R1JHNHlTMnhGUVV4TVQwc3lSVkV6UzI0S2JuTTNibFp1VGtzdmR6bEdSVTloUzJ4U05UZFZNbFozZEU1cldXNVpkM2RUVFZaWVVGaFJXRU52WlVzMVpraHRjR0V5TTNwU1UzazBkMkprQ2kwdExTMHRSVTVFSUVORlVsUkpSa2xEUVZSRkxTMHRMUzBLCiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmNFRkpRa0ZCUzBOQlVVVkJlRWxPT1ZObFMzcG5abXRaV1dNNWFDdDZVMGM0TUhwRGVuZDJURTUyVmpCdFdYcHhiR1VyWVZoNmNXSk9VRGhLQ21kT2IzZ3dTbFp3VlhsNE5WSlFTakZ3UWtwV2IxbHhUQzluUkdGVVdYRlVURU5qVEd4c2JHRkVTMVpWWWpKVmREZHpkRVF4T1ZSb2FrdDNlR3BoZG5nS2EzVk9jSFp5UzFOSmJtSlBaRzVPVlVGR1duWkJWRWhXTkVnelYyWk5TREZGUWpSd1R6Z3ZWVTVpYkRBNU9VcHBTamhTUTBaTVNWUkdXbWw1UkdWMmRBb3djaXRsVVRNelZqbHZSRWhMUlhwMmVuWndiVTB2VTBadU1WUlBjMlV3Y0hsMlowaFFUVTV4VnpSVE5XVkJPV1F6UTJ4MFJGZG9jbHBwWjJscGVHWTBDbVp3UzI4dmNYb3ZibmhtYldKUmR6Y3lORmt3ZUVOeWN6TnVTbk53TDBOMWNrRjNZV0p0Vmt0SFFYVkJlVGhrTkcxSFpuZGtkV2xSTm1sNmFrRXdTWGtLZW1ob1YwbHFjRE5XVERaV09HRXhNbTEyTWxwd1Z5dFZNWE12Wm5ORk9IQjJiVVYwU0ZGSlJFRlJRVUpCYjBsQ1FVSnNXWE5HT1VsVE1Hb3pXRkZ4TkFwdFpsZDRkRGR3U0RZeFUxUlBPVzVTTTFGRk1VdE5ha0ZDT1ZKRGJHVlNTRUpQTTBkMGRXZHNZbFpzWVVGcFdTOWpObUlyTm0xaFZXNVRkbU0xYTNSakNrWldSamRyT0ZsSWNteExNVkJIWmtZd1FpOWtkbVJzYm5wMFR6ZElaMVZqTmxkTE9YcEdWRnBoV0c1cFozZDZTMGxWY1U0eU0wWXpRVkpSWTJoMk5pc0tZMkZLY210WWRubGxXR1ZaWmxKeE9USjNWWGRFYVc1dVRXZHFNVEpDY0VkeVVsVkRWbUZaVkRkeGRHVlBPVWx4VFhad05sY3JlbTFNVms4elFuTmtaQW96Vnk5WVNrTllhMFZNVEZwcFQxTm9OWGxIWm1SRFFtMHdNazFrVmpsTFFXTlVWbmszTUZSSFNrMUlOMmhPTDBOMFVsWldPRmhWSzIxR1RXMXpkREozQ2xVM1dub3dValZQUjFKb1ZWVnVSVlEwVEhSVlVXeFNUSGRZYlV0d09GZEJjMUV2UW5GU05VcHRkbUZxVjJKWFZDOHdkSEZPUTJkVVZGRnRTamRsVFdRS1J6VXZZa05SUlVObldVVkJNamg2S3pGR2IxZzJkMVZJZDBGSlVYSTBWME5qZW5kVldUQk5jWE4yVWxsSE4yWjBZa2hJZG1wc0wybHhOek5FWTBGVFlncERLemxuWVdWSldtZGpibWRWUkc1cmVFcFRUUzlUVjNjMkszUnJNazlzZFVkUlptSk1ibXczZERCMVQxTkxlSE5UUVRoWmF5dHdLMk5ITms5TlVIZFFDa0ZoTlZSRlMyVjJLMjkyTW5WdGRFaHRkMmg2Y2tsTFRtVXdNek5JUTIxblNHWlBZblU1TUZweU5HZElhWGR1TTBSalRVbEJNVEJEWjFsRlFUVlBRM1lLTUcxaVZuUnhPR0Z6VjFsNFJVUlJORXhOYUVnMlZHbEJSMmxVWm5Vd2MwWjJabHBuWjNWTVpVeHpkRFptVUZnNVVuTlBZMHQyUVdGTlZYZFJVVUpOTmdwcGJVZHJNamQ1TTFkQk1ESjJTakEwY0RoaWVXdElTbUpPYVVKd2NYTlZVRU5MZW14UWJUZFpNa3MwVldsRlFYZHNUREJ5VVN0d1RFZFVhVkZNT0hZeUNqUlphSGxDTlcxWmVIUmhiR2szTkdkd1JYTnRTMFJqUkdoRk9ERkpaRkl2YzNseFN6bE5SVU5uV1VWQmNVbG1WREZIY1VnNFJraGFSVmRaUkN0VVJEY0tVblpSU1VKa2QxbFFNRXRQTVVOSlFYbzJaa1Z6U0habmVIbEpibGRvY1U0M01tSktia05aWVhaTFRsaGtUM2RQT1hCUFdWUjJiVFZaUVhOTVRtazBNUXBzYzJWd1ZGVmphMnAyVWtZd2JqaDVVREJaYWpaRVdtbFpSRGRGYXpsaFVXZDNPWGMzVmtwR05HMTFlVGhHYTFabVJTOU5jMkpqWjFkRGVqbHFaMEl3Q201elMwMDFSWGw0VW5ncllpdFJXRnBCYUhCTFlVcHJRMmRaUlVGdFl6bE9SMDgwTW5KUFFXSTFhQ3QzTVZKNmFYRXlWMnQyWkhoVllXb3hhR2hVU1hvS2JEWmtZekJHYVRWNU1sTXJNbVk1VG5sRFNtOWliM0ZSWWpWVFdWUjRZMk12YVZsRlltYzNlV1l4TDFJMmQzTldTMlJ6VHpRelpWZFRSbVZpTmpCRmJRcHBNRkF4WjNaR2JrWkxXbGc0WjBOQ1NsWlFSRWxaTjNkRVVFUjNTazAzUkVOSGJIcHBRbll5YVZwc2VVRjFhM2RqYm1neVIyZDRkV1J3Ym5OTlQwaHVDazR6V21ScU5FVkRaMWxDZVdndmNYQnhOV3RUYUdRelNuZHBOR0pXTUVsTFVDdGlWemt3UkRKYVVrRlNZWEpwZVUxdWRXMTFkMFZOY210cWNrOHZPRWdLYWxweFozZGlTR2hZZG5VMFdUWnhSRVE1VUdsTlJqaHBaMnRCVGpOaVVHRTVTazFIVXpsNU56WjNWVVJoZWsxelRuQkViUzlIVDJWa1FVVlNhRkpEVVFvclVHZDFXSGt3TmxCbFIwZFdkbWRsTUV4b1VqUjFWMmR2VGtKR1RTdFdTR2x6YWxsVWEwTnFWMUZSTDIxdE1UWk5SVlZqYzJjOVBRb3RMUzB0TFVWT1JDQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUW89Cg==",
      "provider": "gcp",
      "publicDns": "ec2-1-2-3-1.compute-1.amazonaws.com",
      "publicIp": "1.2.3.1",
      "region": "america",
      "registryPassword": "<password-1>",
      "size": "small",
      "sshPrivateKey": "<private-key-1>"
    },
    "hostname": "q8s-0.dummy.com",
    "kubeconfig": {
      "apiVersion": "v1",
      "clusters": [
        {
          "cluster": {
            "server": "https://q8s-0.dummy.com:7443"
          },
          "name": "q8s-0"
        }
      ],
      "contexts": [
        {
          "name": "q8s-0",
          "context": {
            "cluster": "q8s-0",
            "user": "q8s-0"
          }
        }
      ],
      "current-context": "q8s-0",
      "kind": "Config",
      "preferences": {},
      "users": [
        {
          "name": "q8s-0",
          "user": {
            "client-certificate-data": "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLVENDQWhHZ0F3SUJBZ0lJYnlHa2xLaHo0bVF3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TkRBNU1UZ3dOVE15TVRSYUZ3MHlOVEE1TVRnd05UTTNNVGxhTUR3eApIekFkQmdOVkJBb1RGbXQxWW1WaFpHMDZZMngxYzNSbGNpMWhaRzFwYm5NeEdUQVhCZ05WQkFNVEVHdDFZbVZ5CmJtVjBaWE10WVdSdGFXNHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFERWczMUoKNHJPQitSaGh6Mkg3TklielRNTFBDOHMyOVhTWmpPcVY3NXBmT3BzMC93bUEyakhRbFdsVExIbEU4bldrRWxXaAppb3YrQU5wTmlwTXNKd3VXV1ZvTXBWUnZaUzN1eTBQWDFPR01yREdOcS9HUzQybStzcElpZHM1MmMxUUFWbThCCk1kWGdmZFo4d2ZVUUhpazd6OVExdVhUMzBtSW54RUlVc2hNVm1MSU42KzNTdjU1RGZkWDJnTWNvVE8vTyttWXoKOUlXZlZNNng3U25LK0FjOHcycGJoTGw0RDEzY0tXME5hR3RtS0NLTEYvaCtrcWorclArZkYrWnRERHZiaGpURQpLdXplY215bjhLNnNEQnB1WlVvWUM0REx4M2lZWi9CMjZKRHFMT01EUWpMT0dGWWlPbmRVdnBYeHJYYWEvWm1sCmI1VFd6OSt3VHltK1lTMGRBZ01CQUFHalZqQlVNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUsKQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkpBSDNTOWFvcER0ODQ2TQpaOXBCY0sraklSOWhNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJOLzlGVEVXV3pucFNCWFhDNnYzRmZJNVhpClJSc0RGNUpZUE1Wem5zTlI3czJTeWNUYitkN201M0VFQjJSM1pDTGpOdTU2TEtEUzNlSE9Bc1pOb3FlRU9tNXYKdVUwVnJNZTE4eXpjVjhiZXk2eGU4VFVnWXZGbGM5M1hLTW85SjhqN1NvS0Y4LzJ0ZnZBckVFVWFHb0ZBc2hIUQpleUoyYWNVUzlEWmN5Wm80K3JNTDNwVzllUmd3KzZkclNtQUNsRSs1bmVxUXNBejFqRFVFM0U5R1EySEl1R0paClRNTXFYSk1YN1Y2ZEtQRzUrUkdwaFZDcHorQjVuSWZmZmhPcldnWjVNMnl4SmxGRG4yS2xFQUxMT0syRVEzS24KbnM3blZuTksvdzlGRU9hS2xSNTdVMlZ3dE5rWW5Zd3dTTVZYUFhRWENvZUs1ZkhtcGEyM3pSU3k0d2JkCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K",
            "client-key-data": "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeElOOVNlS3pnZmtZWWM5aCt6U0c4MHpDend2TE52VjBtWXpxbGUrYVh6cWJOUDhKCmdOb3gwSlZwVXl4NVJQSjFwQkpWb1lxTC9nRGFUWXFUTENjTGxsbGFES1ZVYjJVdDdzdEQxOVRoakt3eGphdngKa3VOcHZyS1NJbmJPZG5OVUFGWnZBVEhWNEgzV2ZNSDFFQjRwTzgvVU5ibDA5OUppSjhSQ0ZMSVRGWml5RGV2dAowcitlUTMzVjlvREhLRXp2enZwbU0vU0ZuMVRPc2UwcHl2Z0hQTU5xVzRTNWVBOWQzQ2x0RFdoclppZ2lpeGY0CmZwS28vcXovbnhmbWJRdzcyNFkweENyczNuSnNwL0N1ckF3YWJtVktHQXVBeThkNG1HZndkdWlRNml6akEwSXkKemhoV0lqcDNWTDZWOGExMm12MlpwVytVMXMvZnNFOHB2bUV0SFFJREFRQUJBb0lCQUJsWXNGOUlTMGozWFFxNAptZld4dDdwSDYxU1RPOW5SM1FFMUtNakFCOVJDbGVSSEJPM0d0dWdsYlZsYUFpWS9jNmIrNm1hVW5TdmM1a3RjCkZWRjdrOFlIcmxLMVBHZkYwQi9kdmRsbnp0TzdIZ1VjNldLOXpGVFphWG5pZ3d6S0lVcU4yM0YzQVJRY2h2NisKY2FKcmtYdnllWGVZZlJxOTJ3VXdEaW5uTWdqMTJCcEdyUlVDVmFZVDdxdGVPOUlxTXZwNlcrem1MVk8zQnNkZAozVy9YSkNYa0VMTFppT1NoNXlHZmRDQm0wMk1kVjlLQWNUVnk3MFRHSk1IN2hOL0N0UlZWOFhVK21GTW1zdDJ3ClU3WnowUjVPR1JoVVVuRVQ0THRVUWxSTHdYbUtwOFdBc1EvQnFSNUptdmFqV2JXVC8wdHFOQ2dUVFFtSjdlTWQKRzUvYkNRRUNnWUVBMjh6KzFGb1g2d1VId0FJUXI0V0NjendVWTBNcXN2UllHN2Z0YkhIdmpsL2lxNzNEY0FTYgpDKzlnYWVJWmdjbmdVRG5reEpTTS9TV3c2K3RrMk9sdUdRZmJMbmw3dDB1T1NLeHNTQThZaytwK2NHNk9NUHdQCkFhNVRFS2V2K292MnVtdEhtd2h6cklLTmUwMzNIQ21nSGZPYnU5MFpyNGdIaXduM0RjTUlBMTBDZ1lFQTVPQ3YKMG1iVnRxOGFzV1l4RURRNExNaEg2VGlBR2lUZnUwc0Z2ZlpnZ3VMZUxzdDZmUFg5UnNPY0t2QWFNVXdRUUJNNgppbUdrMjd5M1dBMDJ2SjA0cDhieWtISmJOaUJwcXNVUENLemxQbTdZMks0VWlFQXdsTDByUStwTEdUaVFMOHYyCjRZaHlCNW1ZeHRhbGk3NGdwRXNtS0RjRGhFODFJZFIvc3lxSzlNRUNnWUVBcUlmVDFHcUg4RkhaRVdZRCtURDcKUnZRSUJkd1lQMEtPMUNJQXo2ZkVzSHZneHlJbldocU43MmJKbkNZYXZLTlhkT3dPOXBPWVR2bTVZQXNMTmk0MQpsc2VwVFVja2p2UkYwbjh5UDBZajZEWmlZRDdFazlhUWd3OXc3VkpGNG11eThGa1ZmRS9Nc2JjZ1dDejlqZ0IwCm5zS001RXl4UngrYitRWFpBaHBLYUprQ2dZRUFtYzlOR080MnJPQWI1aCt3MVJ6aXEyV2t2ZHhVYWoxaGhUSXoKbDZkYzBGaTV5MlMrMmY5TnlDSm9ib3FRYjVTWVR4Y2MvaVlFYmc3eWYxL1I2d3NWS2RzTzQzZVdTRmViNjBFbQppMFAxZ3ZGbkZLWlg4Z0NCSlZQRElZN3dEUER3Sk03RENHbHppQnYyaVpseUF1a3djbmgyR2d4dWRwbnNNT0huCk4zWmRqNEVDZ1lCeWgvcXBxNWtTaGQzSndpNGJWMElLUCtiVzkwRDJaUkFSYXJpeU1udW11d0VNcmtqck8vOEgKalpxZ3diSGhYdnU0WTZxREQ5UGlNRjhpZ2tBTjNiUGE5Sk1HUzl5NzZ3VURhek1zTnBEbS9HT2VkQUVSaFJDUQorUGd1WHkwNlBlR0dWdmdlMExoUjR1V2dvTkJGTStWSGlzallUa0NqV1FRL21tMTZNRVVjc2c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo="
          }
        }
      ]
    },
    "name": "q8s-0",
    "provider": "gcp",
    "region": "america",
    "size": "small"
  });

  // expect.equal(body, {
  //   name: "q8s-1",
  //   hostname: "q8s-1.dummy.com",
  //   kubeconfig: kubeConfigFor("q8s-1"),
  //   provider: "gcp",
  //   region: "america",
  //   size: "small",
  //   sshPrivateKey: "<private-key-1>",
  //   registryPassword: "<password-1>",
  //   publicIp: "1.2.3.1",
  //   instanceId: "i-1",
  //   publicDns: "ec2-1-2-3-1.compute-1.amazonaws.com",
  //   instanceType: { size: "small", name: "t4g.small", dailyCost: 0.2016, monthlyCost: 6.13, vcpu: 2, memory: 2, provider: "gcp" },
  // });
}

test "no host available" {
  let response = http.post("{api.url}/clusters", body: Json.stringify(t.ClusterOptions {
    size: t.Size.xlarge
  }));

  expect.equal(response.status, 503);
  expect.equal(Json.parse(response.body), {
    status: 503,
    error: #"No available clusters that match the request: {\"provider\":\"aws\",\"region\":\"us-east-1\",\"size\":\"xlarge\"}"
  });
}

test "list clusters" {
  http.post("{api.url}/clusters");
  http.post("{api.url}/clusters");
  http.post("{api.url}/clusters");

  let response = http.get("{api.url}/clusters");
  let list = t.ClusterList.parseJson(response.body);

  expect.equal(list, {
    "clusters":[
      "q8s-0",
      "q8s-1"
    ]
  });
}

test "delete cluster" {
  http.post("{api.url}/clusters");

  expect.equal(dns.tryResolve("q8s-0.dummy.com"), "1.2.3.2");

  let r = http.delete("{api.url}/clusters/q8s-0");
  expect.equal(Json.parse(r.body), {
    name: "q8s-0",
    deleted: true,
  });

  expect.nil(dns.tryResolve("q8s-0.dummy.com"));
}

test "delete non existent cluster" {
  http.post("{api.url}/clusters");

  let r = http.delete("{api.url}/clusters/boom");
  expect.equal(Json.parse(r.body), {
    name: "boom",
    deleted: false,
  });
}

test "get cluster" {
  http.post("{api.url}/clusters");

  let response = http.get("{api.url}/clusters/q8s-0");
  let c = t.Cluster.parseJson(response.body);
  
  expect.equal(c, {
    "host": {
      "instanceId": "i-2",
      "instanceType": {
        "size": "small",
        "name": "t4g.small",
        "dailyCost": 0.2016,
        "monthlyCost": 6.13,
        "vcpu": 2,
        "memory": 2,
        "provider": "aws"
      },
      "kubeconfig": "YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VSQ1ZFTkRRV1V5WjBGM1NVSkJaMGxKUlZCRGFHaFhNRTVHUnpoM1JGRlpTa3R2V2tsb2RtTk9RVkZGVEVKUlFYZEdWRVZVVFVKRlIwRXhWVVVLUVhoTlMyRXpWbWxhV0VwMVdsaFNiR042UVdWR2R6QjVUa1JCTlUxVVozZE9WRTE1VFZSU1lVWjNNSHBPUkVFMVRWUlpkMDVVVFROTlZGSmhUVUpWZUFwRmVrRlNRbWRPVmtKQlRWUkRiWFF4V1cxV2VXSnRWakJhV0UxM1oyZEZhVTFCTUVkRFUzRkhVMGxpTTBSUlJVSkJVVlZCUVRSSlFrUjNRWGRuWjBWTENrRnZTVUpCVVVNMFlsUnZWME5GTm5NeWNuRnVia2hxS3padldFVnpVMEZyTUdoak5WUkJURk40VUhjM1NHVjVUMEpQZVc1eFpFUnZSSFJ2U3pSUU5rSUtWVzR5UkRobWJqWmFRVGhXWlhGR1J6QnZjV00wT0ZsR016bDBhbnBSU1VWVVdqRllSbk5HTDBkVVNrRk9WVlZ3T0Vob01YbzFjVEp3VG5KTmJqZ3ZjUXB6UmxSeVJrUk9Va1JvUmxOeVZGcGxiMVI1T0dkMmNXeDFSVnBSU0M5YVdUVnNRekJ3YjJ4eE1FRnJiV2RuTjJ4RVQyeG9Xak50YVVGcVl5dElSbkExQ2pNdk1rVktURE5OZVhaTVpWcG9URk5IZFZKNmNuaERUV3A0VUVOalZsZDZSbFYwZEdZeFRVOUJiVE52U1RsNWEzaERjak0xV1cxR1NGTnFXR1pQVjNvS2RUUmljemQxUlRBNU1uVk5iREl5Ym5WRlVtWjBaRmR4ZVhaWE1WZHJlalpXYzBRMWNqSldURFJyZUhwUlRUTmhXbXR3VDNGU2RYSjZiSFZRWWtKMVlRcFpkVnBPTkU4MmRVaFdZWFIyYmxRMmVXMXFTbE54ZWxrek1XVklRV2ROUWtGQlIycFhWRUpZVFVFMFIwRXhWV1JFZDBWQ0wzZFJSVUYzU1VOd1JFRlFDa0puVGxaSVVrMUNRV1k0UlVKVVFVUkJVVWd2VFVJd1IwRXhWV1JFWjFGWFFrSlRVVUk1TUhaWGNVdFJOMlpQVDJwSFptRlJXRU4yYjNsRlpsbFVRVllLUW1kT1ZraFNSVVZFYWtGTloyZHdjbVJYU214amJUVnNaRWRXZWsxQk1FZERVM0ZIVTBsaU0wUlJSVUpEZDFWQlFUUkpRa0ZSUXpCUmNVMXpSakpyU0FweE5uZ3hhakZyVEVSU1dUTk1hVEZZVEhwNlpISlZSWGhPYUd3dmFHWXpNV1ZMZUcxeVUyUXlWblpUY1ZKSldERnJaVTlvV0dOaFNHOUpVMnByWTFkbUNrcFJkVXhzTDFab1J6QnZkMUJET0RjMFdFZE9VRTVxVkVnNFkwWkhVVU5PWmtSeVJqTnhUWGx4TDBOcFRXbHhkVkIxVUVocVNrZERla1pCU0ZoV1VUa0tiVFZhVmpVelptSjNjVFJtTkV3MFUwWm1SR1JRU1dvMFpYZGFhVzFsTWtsc1FtaE5Na3A0TDBsaE1uQTFhVFF4Y25VclltWTVhamRaY2tvemJFUldaUXB0VVRWbmJIbHFUa0paUkdkMmQxZ3dLMFEwZGxaMFRUZDNPRzFQU2k5TFluVTVNalJuV0hOdU4zcDVVM2RRTnpjMk1rWlZiV2RQVFd4SVlVOUJiVTlYQ21OWFdqZFpWRFpUWkZWVFZYcEhRbFp5UW5SMmNXUldkRm9yTjFkQk16Uk9aMjAzTW0xRFoyczJZbXB5TkZFMk1ISXZUbG92Y1hNMlMxZzFPSFV3ZW5NS1kwOUlibGxoY3pjeWFsRlJDaTB0TFMwdFJVNUVJRU5GVWxSSlJrbERRVlJGTFMwdExTMEsKICAgIHNlcnZlcjogaHR0cHM6Ly8wLjAuMC4wOjc0NDMKICBuYW1lOiBraW5kLWtpbmQKY29udGV4dHM6Ci0gY29udGV4dDoKICAgIGNsdXN0ZXI6IGtpbmQta2luZAogICAgdXNlcjoga2luZC1raW5kCiAgbmFtZToga2luZC1raW5kCmN1cnJlbnQtY29udGV4dDoga2luZC1raW5kCmtpbmQ6IENvbmZpZwpwcmVmZXJlbmNlczoge30KdXNlcnM6Ci0gbmFtZToga2luZC1raW5kCiAgdXNlcjoKICAgIGNsaWVudC1jZXJ0aWZpY2F0ZS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VSTFZFTkRRV2hIWjBGM1NVSkJaMGxKWW5sSGEyeExhSG8wYlZGM1JGRlpTa3R2V2tsb2RtTk9RVkZGVEVKUlFYZEdWRVZVVFVKRlIwRXhWVVVLUVhoTlMyRXpWbWxhV0VwMVdsaFNiR042UVdWR2R6QjVUa1JCTlUxVVozZE9WRTE1VFZSU1lVWjNNSGxPVkVFMVRWUm5kMDVVVFROTlZHeGhUVVIzZUFwSWVrRmtRbWRPVmtKQmIxUkdiWFF4V1cxV2FGcEhNRFpaTW5neFl6TlNiR05wTVdoYVJ6RndZbTVOZUVkVVFWaENaMDVXUWtGTlZFVkhkREZaYlZaNUNtSnRWakJhV0UxMFdWZFNkR0ZYTkhkblowVnBUVUV3UjBOVGNVZFRTV0l6UkZGRlFrRlJWVUZCTkVsQ1JIZEJkMmRuUlV0QmIwbENRVkZFUldjek1Vb0tOSEpQUWl0U2FHaDZNa2czVGtsaWVsUk5URkJET0hNeU9WaFRXbXBQY1ZZM05YQm1UM0J6TUM5M2JVRXlha2hSYkZkc1ZFeEliRVU0YmxkclJXeFhhQXBwYjNZclFVNXdUbWx3VFhOS2QzVlhWMVp2VFhCV1VuWmFVek4xZVRCUVdERlBSMDF5UkVkT2NTOUhVelF5YlN0emNFbHBaSE0xTW1NeFVVRldiVGhDQ2sxa1dHZG1aRm80ZDJaVlVVaHBhemQ2T1ZFeGRWaFVNekJ0U1c1NFJVbFZjMmhOVm0xTVNVNDJLek5UZGpVMVJHWmtXREpuVFdOdlZFOHZUeXR0V1hvS09VbFhabFpOTm5nM1UyNUxLMEZqT0hjeWNHSm9UR3cwUkRFelkwdFhNRTVoUjNSdFMwTkxURVl2YUN0cmNXb3JjbEFyWmtZclduUkVSSFppYUdwVVJRcExkWHBsWTIxNWJqaExObk5FUW5CMVdsVnZXVU0wUkV4NE0ybFpXaTlDTWpaS1JIRk1UMDFFVVdwTVQwZEdXV2xQYm1SVmRuQlllSEpZWVdFdldtMXNDbUkxVkZkNk9TdDNWSGx0SzFsVE1HUkJaMDFDUVVGSGFsWnFRbFZOUVRSSFFURlZaRVIzUlVJdmQxRkZRWGRKUm05RVFWUkNaMDVXU0ZOVlJVUkVRVXNLUW1kbmNrSm5SVVpDVVdORVFXcEJUVUpuVGxaSVVrMUNRV1k0UlVGcVFVRk5RamhIUVRGVlpFbDNVVmxOUW1GQlJrcEJTRE5UT1dGdmNFUjBPRFEyVFFwYU9YQkNZMHNyYWtsU09XaE5RVEJIUTFOeFIxTkpZak5FVVVWQ1EzZFZRVUUwU1VKQlVVSk9MemxHVkVWWFYzcHVjRk5DV0ZoRE5uWXpSbVpKTlZocENsSlNjMFJHTlVwWlVFMVdlbTV6VGxJM2N6SlRlV05VWWl0a04yMDFNMFZGUWpKU00xcERUR3BPZFRVMlRFdEVVek5sU0U5QmMxcE9iM0ZsUlU5dE5YWUtkVlV3Vm5KTlpURTRlWHBqVmpoaVpYazJlR1U0VkZWbldYWkdiR001TTFoTFRXODVTamhxTjFOdlMwWTRMekowWm5aQmNrVkZWV0ZIYjBaQmMyaElVUXBsZVVveVlXTlZVemxFV21ONVdtODBLM0pOVEROd1Z6bGxVbWQzS3paa2NsTnRRVU5zUlNzMWJtVnhVWE5CZWpGcVJGVkZNMFU1UjFFeVNFbDFSMHBhQ2xSTlRYRllTazFZTjFZMlpFdFFSelVyVWtkd2FGWkRjSG9yUWpWdVNXWm1abWhQY2xkbldqVk5Nbmw0U214R1JHNHlTMnhGUVV4TVQwc3lSVkV6UzI0S2JuTTNibFp1VGtzdmR6bEdSVTloUzJ4U05UZFZNbFozZEU1cldXNVpkM2RUVFZaWVVGaFJXRU52WlVzMVpraHRjR0V5TTNwU1UzazBkMkprQ2kwdExTMHRSVTVFSUVORlVsUkpSa2xEUVZSRkxTMHRMUzBLCiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmNFRkpRa0ZCUzBOQlVVVkJlRWxPT1ZObFMzcG5abXRaV1dNNWFDdDZVMGM0TUhwRGVuZDJURTUyVmpCdFdYcHhiR1VyWVZoNmNXSk9VRGhLQ21kT2IzZ3dTbFp3VlhsNE5WSlFTakZ3UWtwV2IxbHhUQzluUkdGVVdYRlVURU5qVEd4c2JHRkVTMVpWWWpKVmREZHpkRVF4T1ZSb2FrdDNlR3BoZG5nS2EzVk9jSFp5UzFOSmJtSlBaRzVPVlVGR1duWkJWRWhXTkVnelYyWk5TREZGUWpSd1R6Z3ZWVTVpYkRBNU9VcHBTamhTUTBaTVNWUkdXbWw1UkdWMmRBb3djaXRsVVRNelZqbHZSRWhMUlhwMmVuWndiVTB2VTBadU1WUlBjMlV3Y0hsMlowaFFUVTV4VnpSVE5XVkJPV1F6UTJ4MFJGZG9jbHBwWjJscGVHWTBDbVp3UzI4dmNYb3ZibmhtYldKUmR6Y3lORmt3ZUVOeWN6TnVTbk53TDBOMWNrRjNZV0p0Vmt0SFFYVkJlVGhrTkcxSFpuZGtkV2xSTm1sNmFrRXdTWGtLZW1ob1YwbHFjRE5XVERaV09HRXhNbTEyTWxwd1Z5dFZNWE12Wm5ORk9IQjJiVVYwU0ZGSlJFRlJRVUpCYjBsQ1FVSnNXWE5HT1VsVE1Hb3pXRkZ4TkFwdFpsZDRkRGR3U0RZeFUxUlBPVzVTTTFGRk1VdE5ha0ZDT1ZKRGJHVlNTRUpQTTBkMGRXZHNZbFpzWVVGcFdTOWpObUlyTm0xaFZXNVRkbU0xYTNSakNrWldSamRyT0ZsSWNteExNVkJIWmtZd1FpOWtkbVJzYm5wMFR6ZElaMVZqTmxkTE9YcEdWRnBoV0c1cFozZDZTMGxWY1U0eU0wWXpRVkpSWTJoMk5pc0tZMkZLY210WWRubGxXR1ZaWmxKeE9USjNWWGRFYVc1dVRXZHFNVEpDY0VkeVVsVkRWbUZaVkRkeGRHVlBPVWx4VFhad05sY3JlbTFNVms4elFuTmtaQW96Vnk5WVNrTllhMFZNVEZwcFQxTm9OWGxIWm1SRFFtMHdNazFrVmpsTFFXTlVWbmszTUZSSFNrMUlOMmhPTDBOMFVsWldPRmhWSzIxR1RXMXpkREozQ2xVM1dub3dValZQUjFKb1ZWVnVSVlEwVEhSVlVXeFNUSGRZYlV0d09GZEJjMUV2UW5GU05VcHRkbUZxVjJKWFZDOHdkSEZPUTJkVVZGRnRTamRsVFdRS1J6VXZZa05SUlVObldVVkJNamg2S3pGR2IxZzJkMVZJZDBGSlVYSTBWME5qZW5kVldUQk5jWE4yVWxsSE4yWjBZa2hJZG1wc0wybHhOek5FWTBGVFlncERLemxuWVdWSldtZGpibWRWUkc1cmVFcFRUUzlUVjNjMkszUnJNazlzZFVkUlptSk1ibXczZERCMVQxTkxlSE5UUVRoWmF5dHdLMk5ITms5TlVIZFFDa0ZoTlZSRlMyVjJLMjkyTW5WdGRFaHRkMmg2Y2tsTFRtVXdNek5JUTIxblNHWlBZblU1TUZweU5HZElhWGR1TTBSalRVbEJNVEJEWjFsRlFUVlBRM1lLTUcxaVZuUnhPR0Z6VjFsNFJVUlJORXhOYUVnMlZHbEJSMmxVWm5Vd2MwWjJabHBuWjNWTVpVeHpkRFptVUZnNVVuTlBZMHQyUVdGTlZYZFJVVUpOTmdwcGJVZHJNamQ1TTFkQk1ESjJTakEwY0RoaWVXdElTbUpPYVVKd2NYTlZVRU5MZW14UWJUZFpNa3MwVldsRlFYZHNUREJ5VVN0d1RFZFVhVkZNT0hZeUNqUlphSGxDTlcxWmVIUmhiR2szTkdkd1JYTnRTMFJqUkdoRk9ERkpaRkl2YzNseFN6bE5SVU5uV1VWQmNVbG1WREZIY1VnNFJraGFSVmRaUkN0VVJEY0tVblpSU1VKa2QxbFFNRXRQTVVOSlFYbzJaa1Z6U0habmVIbEpibGRvY1U0M01tSktia05aWVhaTFRsaGtUM2RQT1hCUFdWUjJiVFZaUVhOTVRtazBNUXBzYzJWd1ZGVmphMnAyVWtZd2JqaDVVREJaYWpaRVdtbFpSRGRGYXpsaFVXZDNPWGMzVmtwR05HMTFlVGhHYTFabVJTOU5jMkpqWjFkRGVqbHFaMEl3Q201elMwMDFSWGw0VW5ncllpdFJXRnBCYUhCTFlVcHJRMmRaUlVGdFl6bE9SMDgwTW5KUFFXSTFhQ3QzTVZKNmFYRXlWMnQyWkhoVllXb3hhR2hVU1hvS2JEWmtZekJHYVRWNU1sTXJNbVk1VG5sRFNtOWliM0ZSWWpWVFdWUjRZMk12YVZsRlltYzNlV1l4TDFJMmQzTldTMlJ6VHpRelpWZFRSbVZpTmpCRmJRcHBNRkF4WjNaR2JrWkxXbGc0WjBOQ1NsWlFSRWxaTjNkRVVFUjNTazAzUkVOSGJIcHBRbll5YVZwc2VVRjFhM2RqYm1neVIyZDRkV1J3Ym5OTlQwaHVDazR6V21ScU5FVkRaMWxDZVdndmNYQnhOV3RUYUdRelNuZHBOR0pXTUVsTFVDdGlWemt3UkRKYVVrRlNZWEpwZVUxdWRXMTFkMFZOY210cWNrOHZPRWdLYWxweFozZGlTR2hZZG5VMFdUWnhSRVE1VUdsTlJqaHBaMnRCVGpOaVVHRTVTazFIVXpsNU56WjNWVVJoZWsxelRuQkViUzlIVDJWa1FVVlNhRkpEVVFvclVHZDFXSGt3TmxCbFIwZFdkbWRsTUV4b1VqUjFWMmR2VGtKR1RTdFdTR2x6YWxsVWEwTnFWMUZSTDIxdE1UWk5SVlZqYzJjOVBRb3RMUzB0TFVWT1JDQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUW89Cg==",
      "provider": "aws",
      "publicDns": "ec2-1-2-3-2.compute-1.amazonaws.com",
      "publicIp": "1.2.3.2",
      "region": "us-east-1",
      "registryPassword": "<password-2>",
      "size": "medium",
      "sshPrivateKey": "<private-key-2>"
    },
    "hostname": "q8s-0.dummy.com",
    "kubeconfig": {
      "apiVersion": "v1",
      "clusters": [
        {
          "cluster": {
            "server": "https://q8s-0.dummy.com:7443"
          },
          "name": "q8s-0"
        }
      ],
      "contexts": [
        {
          "name": "q8s-0",
          "context": {
            "cluster": "q8s-0",
            "user": "q8s-0"
          }
        }
      ],
      "current-context": "q8s-0",
      "kind": "Config",
      "preferences": {},
      "users": [
        {
          "name": "q8s-0",
          "user": {
            "client-certificate-data": "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURLVENDQWhHZ0F3SUJBZ0lJYnlHa2xLaHo0bVF3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TkRBNU1UZ3dOVE15TVRSYUZ3MHlOVEE1TVRnd05UTTNNVGxhTUR3eApIekFkQmdOVkJBb1RGbXQxWW1WaFpHMDZZMngxYzNSbGNpMWhaRzFwYm5NeEdUQVhCZ05WQkFNVEVHdDFZbVZ5CmJtVjBaWE10WVdSdGFXNHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFERWczMUoKNHJPQitSaGh6Mkg3TklielRNTFBDOHMyOVhTWmpPcVY3NXBmT3BzMC93bUEyakhRbFdsVExIbEU4bldrRWxXaAppb3YrQU5wTmlwTXNKd3VXV1ZvTXBWUnZaUzN1eTBQWDFPR01yREdOcS9HUzQybStzcElpZHM1MmMxUUFWbThCCk1kWGdmZFo4d2ZVUUhpazd6OVExdVhUMzBtSW54RUlVc2hNVm1MSU42KzNTdjU1RGZkWDJnTWNvVE8vTyttWXoKOUlXZlZNNng3U25LK0FjOHcycGJoTGw0RDEzY0tXME5hR3RtS0NLTEYvaCtrcWorclArZkYrWnRERHZiaGpURQpLdXplY215bjhLNnNEQnB1WlVvWUM0REx4M2lZWi9CMjZKRHFMT01EUWpMT0dGWWlPbmRVdnBYeHJYYWEvWm1sCmI1VFd6OSt3VHltK1lTMGRBZ01CQUFHalZqQlVNQTRHQTFVZER3RUIvd1FFQXdJRm9EQVRCZ05WSFNVRUREQUsKQmdnckJnRUZCUWNEQWpBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkpBSDNTOWFvcER0ODQ2TQpaOXBCY0sraklSOWhNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJOLzlGVEVXV3pucFNCWFhDNnYzRmZJNVhpClJSc0RGNUpZUE1Wem5zTlI3czJTeWNUYitkN201M0VFQjJSM1pDTGpOdTU2TEtEUzNlSE9Bc1pOb3FlRU9tNXYKdVUwVnJNZTE4eXpjVjhiZXk2eGU4VFVnWXZGbGM5M1hLTW85SjhqN1NvS0Y4LzJ0ZnZBckVFVWFHb0ZBc2hIUQpleUoyYWNVUzlEWmN5Wm80K3JNTDNwVzllUmd3KzZkclNtQUNsRSs1bmVxUXNBejFqRFVFM0U5R1EySEl1R0paClRNTXFYSk1YN1Y2ZEtQRzUrUkdwaFZDcHorQjVuSWZmZmhPcldnWjVNMnl4SmxGRG4yS2xFQUxMT0syRVEzS24KbnM3blZuTksvdzlGRU9hS2xSNTdVMlZ3dE5rWW5Zd3dTTVZYUFhRWENvZUs1ZkhtcGEyM3pSU3k0d2JkCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K",
            "client-key-data": "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeElOOVNlS3pnZmtZWWM5aCt6U0c4MHpDend2TE52VjBtWXpxbGUrYVh6cWJOUDhKCmdOb3gwSlZwVXl4NVJQSjFwQkpWb1lxTC9nRGFUWXFUTENjTGxsbGFES1ZVYjJVdDdzdEQxOVRoakt3eGphdngKa3VOcHZyS1NJbmJPZG5OVUFGWnZBVEhWNEgzV2ZNSDFFQjRwTzgvVU5ibDA5OUppSjhSQ0ZMSVRGWml5RGV2dAowcitlUTMzVjlvREhLRXp2enZwbU0vU0ZuMVRPc2UwcHl2Z0hQTU5xVzRTNWVBOWQzQ2x0RFdoclppZ2lpeGY0CmZwS28vcXovbnhmbWJRdzcyNFkweENyczNuSnNwL0N1ckF3YWJtVktHQXVBeThkNG1HZndkdWlRNml6akEwSXkKemhoV0lqcDNWTDZWOGExMm12MlpwVytVMXMvZnNFOHB2bUV0SFFJREFRQUJBb0lCQUJsWXNGOUlTMGozWFFxNAptZld4dDdwSDYxU1RPOW5SM1FFMUtNakFCOVJDbGVSSEJPM0d0dWdsYlZsYUFpWS9jNmIrNm1hVW5TdmM1a3RjCkZWRjdrOFlIcmxLMVBHZkYwQi9kdmRsbnp0TzdIZ1VjNldLOXpGVFphWG5pZ3d6S0lVcU4yM0YzQVJRY2h2NisKY2FKcmtYdnllWGVZZlJxOTJ3VXdEaW5uTWdqMTJCcEdyUlVDVmFZVDdxdGVPOUlxTXZwNlcrem1MVk8zQnNkZAozVy9YSkNYa0VMTFppT1NoNXlHZmRDQm0wMk1kVjlLQWNUVnk3MFRHSk1IN2hOL0N0UlZWOFhVK21GTW1zdDJ3ClU3WnowUjVPR1JoVVVuRVQ0THRVUWxSTHdYbUtwOFdBc1EvQnFSNUptdmFqV2JXVC8wdHFOQ2dUVFFtSjdlTWQKRzUvYkNRRUNnWUVBMjh6KzFGb1g2d1VId0FJUXI0V0NjendVWTBNcXN2UllHN2Z0YkhIdmpsL2lxNzNEY0FTYgpDKzlnYWVJWmdjbmdVRG5reEpTTS9TV3c2K3RrMk9sdUdRZmJMbmw3dDB1T1NLeHNTQThZaytwK2NHNk9NUHdQCkFhNVRFS2V2K292MnVtdEhtd2h6cklLTmUwMzNIQ21nSGZPYnU5MFpyNGdIaXduM0RjTUlBMTBDZ1lFQTVPQ3YKMG1iVnRxOGFzV1l4RURRNExNaEg2VGlBR2lUZnUwc0Z2ZlpnZ3VMZUxzdDZmUFg5UnNPY0t2QWFNVXdRUUJNNgppbUdrMjd5M1dBMDJ2SjA0cDhieWtISmJOaUJwcXNVUENLemxQbTdZMks0VWlFQXdsTDByUStwTEdUaVFMOHYyCjRZaHlCNW1ZeHRhbGk3NGdwRXNtS0RjRGhFODFJZFIvc3lxSzlNRUNnWUVBcUlmVDFHcUg4RkhaRVdZRCtURDcKUnZRSUJkd1lQMEtPMUNJQXo2ZkVzSHZneHlJbldocU43MmJKbkNZYXZLTlhkT3dPOXBPWVR2bTVZQXNMTmk0MQpsc2VwVFVja2p2UkYwbjh5UDBZajZEWmlZRDdFazlhUWd3OXc3VkpGNG11eThGa1ZmRS9Nc2JjZ1dDejlqZ0IwCm5zS001RXl4UngrYitRWFpBaHBLYUprQ2dZRUFtYzlOR080MnJPQWI1aCt3MVJ6aXEyV2t2ZHhVYWoxaGhUSXoKbDZkYzBGaTV5MlMrMmY5TnlDSm9ib3FRYjVTWVR4Y2MvaVlFYmc3eWYxL1I2d3NWS2RzTzQzZVdTRmViNjBFbQppMFAxZ3ZGbkZLWlg4Z0NCSlZQRElZN3dEUER3Sk03RENHbHppQnYyaVpseUF1a3djbmgyR2d4dWRwbnNNT0huCk4zWmRqNEVDZ1lCeWgvcXBxNWtTaGQzSndpNGJWMElLUCtiVzkwRDJaUkFSYXJpeU1udW11d0VNcmtqck8vOEgKalpxZ3diSGhYdnU0WTZxREQ5UGlNRjhpZ2tBTjNiUGE5Sk1HUzl5NzZ3VURhek1zTnBEbS9HT2VkQUVSaFJDUQorUGd1WHkwNlBlR0dWdmdlMExoUjR1V2dvTkJGTStWSGlzallUa0NqV1FRL21tMTZNRVVjc2c9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo="
          }
        }
      ]
    },
    "name": "q8s-0",
    "provider": "aws",
    "region": "us-east-1",
    "size": "medium"
  });
}

test "get non existing cluster" {
  let response = http.get("{api.url}/clusters/q8s-0");
  expect.equal(response.status, 404);
  expect.equal(Json.parse(response.body), {
    status: 404,
    error: "Cluster 'q8s-0' not found"
  });
}
